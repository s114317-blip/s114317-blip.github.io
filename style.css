/* ===== 全螢幕版面 ===== */
body{ display:block; }
.frame{ width:100vw; min-height:100vh; padding:20px; }
.panel.full{ min-height:calc(100vh - 80px); }
.game{
  display:grid;
  grid-template-columns: 1.4fr .9fr;
  gap:16px;
  align-items:stretch;
}
.scene{ height: min(76vh, 720px); }
.side{ display:flex; flex-direction:column; gap:12px; }
.hint{ font-size:12px; opacity:.65; margin-top:2px; font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans TC", sans-serif; }

@media (max-width: 900px){
  .game{ grid-template-columns: 1fr; }
  .scene{ height: min(60vh, 560px); }
}

/* ===== 特效層 ===== */
.fxLayer{ position:absolute; inset:0; pointer-events:none; overflow:hidden; z-index:4; }

.particle{
  position:absolute;
  left:50%; top:60%;
  transform:translate(-50%,-50%);
  opacity:.9;
  animation: fly 900ms ease-out forwards;
  filter: drop-shadow(0 8px 10px rgba(0,0,0,.12));
}
@keyframes fly{
  from{ transform:translate(-50%,-50%) scale(1); opacity:1; }
  to  { transform:translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(.9); opacity:0; }
}
.p-leaf{ width:16px; height:10px; border-radius: 12px 12px 12px 0; background:rgba(0,0,0,.55); transform:rotate(20deg); }
.p-sun{ width:14px; height:14px; border-radius:50%; background:rgba(0,0,0,.45); box-shadow:0 0 0 7px rgba(0,0,0,.08); }
.p-dew{ width:10px; height:14px; border-radius: 50% 50% 55% 55%; background:rgba(0,0,0,.35); }
.p-ink{ width:10px; height:10px; border-radius:50%; background:rgba(0,0,0,.35); }

/* ===== 戳毛毛蟲互動動畫 ===== */
.creature{ cursor:pointer; }
.poke{ animation: pokeWiggle 260ms ease-in-out 1; }
@keyframes pokeWiggle{
  0%{ transform:translate(-50%,-50%) scale(1); }
  30%{ transform:translate(-50%,-52%) scale(1.04) rotate(-2deg); }
  60%{ transform:translate(-50%,-48%) scale(0.98) rotate(2deg); }
  100%{ transform:translate(-50%,-50%) scale(1); }
}

/* ===== 毛毛蟲花紋（用水墨紋理，不用彩色也能有差異）===== */
.cat-leaf{ background-image:
  radial-gradient(circle at 32% 55%, rgba(0,0,0,.70) 0 16px, transparent 17px),
  radial-gradient(circle at 46% 55%, rgba(0,0,0,.68) 0 18px, transparent 19px),
  radial-gradient(circle at 60% 55%, rgba(0,0,0,.66) 0 20px, transparent 21px),
  radial-gradient(circle at 74% 55%, rgba(0,0,0,.62) 0 22px, transparent 23px),
  radial-gradient(circle at 86% 52%, rgba(0,0,0,.60) 0 12px, transparent 13px),
  repeating-linear-gradient(45deg, rgba(0,0,0,.10) 0 4px, transparent 4px 9px);
}
.cat-sun{ filter: drop-shadow(0 12px 18px rgba(0,0,0,.14)); opacity:.98; }
.cat-ink{ opacity:.88; }
.cat-spot{ background-image:
  radial-gradient(circle at 32% 55%, rgba(0,0,0,.70) 0 16px, transparent 17px),
  radial-gradient(circle at 46% 55%, rgba(0,0,0,.68) 0 18px, transparent 19px),
  radial-gradient(circle at 60% 55%, rgba(0,0,0,.66) 0 20px, transparent 21px),
  radial-gradient(circle at 74% 55%, rgba(0,0,0,.62) 0 22px, transparent 23px),
  radial-gradient(circle at 86% 52%, rgba(0,0,0,.60) 0 12px, transparent 13px),
  radial-gradient(circle at 40% 40%, rgba(0,0,0,.12) 0 10px, transparent 11px),
  radial-gradient(circle at 62% 62%, rgba(0,0,0,.12) 0 9px, transparent 10px);
}

/* ===== 蝴蝶品種（同樣用紋理區分）===== */
.bfly-leaf{ opacity:1; }
.bfly-sun{ filter: drop-shadow(0 14px 20px rgba(0,0,0,.18)); }
.bfly-ink{ opacity:.85; }
.bfly-spot{ opacity:.92; }

/* ===== 天敵事件卡 ===== */
.enemy{
  position:fixed; inset:0;
  background: rgba(0,0,0,.42);
  display:grid; place-items:center;
  padding:20px;
  z-index:55;
}
.enemyCard{
  width:min(720px, 92vw);
  border-radius:18px;
  border:1px solid rgba(255,255,255,.35);
  background: linear-gradient(180deg, rgba(246,241,230,.95), rgba(239,230,214,.92));
  box-shadow: 0 20px 60px rgba(0,0,0,.28);
  padding:18px;
}
.enemyBtns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
.enemyTip{ margin-top:10px; font-size:12px; opacity:.65; font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans TC", sans-serif; }

/* 結局品種顯示 */
.endingBreed{ opacity:.8; margin-top:6px; font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans TC", sans-serif; }
.hidden { display: none !important; }

.scene { position: relative; }
.creature { position: absolute; z-index: 30; pointer-events: auto; }
.fxLayer { pointer-events: none; z-index: 40; }
.inkwash { z-index: 1; pointer-events: none; }
